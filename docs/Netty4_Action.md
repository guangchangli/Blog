# Netty4 Action

## 网络通信

### 网络五层模型

```
应用层
传输层      四层交换机、四层路由器
网络层      路由器、三层交换机
数据链路层  网桥、以太网交换机、网卡
物理层 		中继器、集线器、双绞线
```

### 数据

- 数据帧

  ```
  Head 18 字节 发送者｜源地址 6 字节 接受者|目标地址 6 字节 数据类型 6 字节
  Data 最短 46字节 最长 1500 字节
  最短 64 字节，最长 1518 字节(超过分片发送)
  ```

- MAC

  ```
  通信数据帧
  目 标  MAC 地址 6B
  发送源 MAC 地址 6B
  TPID 2B
  TCI 2B (含 12 位 VLAN 标识)
  类型 2B
  数据内容 46-1500 字节
  CRC 4B
  ```

- IP

  ```
  32 位二进制 4 段十进制表示
  主机位 + 网络位
  子网掩码 &
  ABCD
  ```

- IP 数据包

  ```
  HEAD 20 - 60 B
  DATA 65515 B
  ```

- ```
  以太网头部｜IP 头部｜TCP[UDP]头部 数据
  ```

- DNS

  ```
  顶级域名 TLD 分为 国家顶级域名 nTLD、通用顶级域名 gTLD、基础结构域名
  域名服务器分为 根域名服务器、顶级域名服务器、本地域名服务器、权限域名服务器
  DNS 使用 TCP|UDP 53 端口，对于每一级域名长度限制是 63 字符，域名总长度不能超过 253 字符
  ```

  

### ARP

```
Ip 找 MAC
广播发出，单播回复
arp -a
```

### Port

```
关联 app 和 网卡
TCP 头部留给存储端口空间 2B 
 0    - 1023  系统保留
1024  - 49152 用户注册
49152 - 65535 随机动态
```

### 建立连接

```
shake_step1:
	client 发送 SYN (syn=1) -> server 进入 SYN_SENT 等待 server 确认
shake_step2:
	server 接受 SYN 确认 client SYN（ack=x+1） 发送 SYN （syn=1）SYN + ACK server 进入 SYN_RECV 状态
shake_step3:
	clent 接收到 server SYN + ACK ，向 server 发送确认包 ACK (sck=y+1) 此包发送完毕，建立起连接
```



### 连接释放

```
wave_step1 
```

### 网络通信原理

```

```

### 浏览器+URL

```
1.DNS 服务器解析域名 -> IP
2.发送 HTTP 请求
3.TCP 设置端口，封装数据
4.IP 封装数据+TCP数据，设置双方IP
5.以太网协议 封装IP数据包，设置双方MAC地址（ARP
6.服务器响应，TCP返回数据
```

### Socket

```
通信双方建立连接后，各自维护一个文件，可以写入内容供对方读取，通信结束关闭文件
```

